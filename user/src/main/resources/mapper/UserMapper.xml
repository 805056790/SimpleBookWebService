<?xml version="1.0" encoding="UTF-8" ?>
<!--
  ~ Copyright (c) 2016 杭州端点网络科技有限公司, Code Generated by terminus code gen
  -->

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="User">

    <resultMap id="UserMap" type="User">
        <id column="id" property="id"/>
        <result column="user_name" property="userName"/>
        <result column="mobile" property="mobile"/>
        <result column="email" property="email"/>
        <result column="password" property="password"/>
        <result column="status" property="status"/>
        <result column="qq_token" property="QqToken"/>
        <result column="weixin_token" property="weixinToken"/>
        <result column="weibo_token" property="weiboToken"/>
        <result column="nickname" property="nickname"/>
        <result column="type" property="type"/>
        <result column="gender" property="gender"/>
        <result column="birthday" property="birthday"/>
        <result column="image" property="image"/>
        <result column="created_at" property="createdAt"/>
        <result column="updated_at" property="updatedAt"/>
    </resultMap>

    <sql id="tb">
        users
    </sql>

    <sql id="cols_all">
        id, <include refid="cols_exclude_id" />
    </sql>

    <sql id="cols_exclude_id">
        `user_name`,`mobile`,`email`,`password`,`status`,`qq_token`,`weixin_token`,`weibo_token`,`nickname`,`type`,`gender`,`birthday`,`image`,`created_at`,`updated_at`
    </sql>

    <sql id="vals">
        #{userName},#{mobile},#{email},#{password},#{status},#{QqToken},#{weixinToken},#{weiboToken},#{nickname},#{type},#{gender},#{birthday},#{image},now(),now()
    </sql>

    <insert id="create" parameterType="User" keyProperty="id" useGeneratedKeys="true">
        INSERT INTO
        <include refid="tb" />
        (<include refid="cols_exclude_id" />)
        VALUES
        (<include refid="vals" />)
    </insert>

    <select id="findById" parameterType="long" resultMap="UserMap" >
        SELECT <include refid="cols_all" />
        FROM <include refid="tb" />
        WHERE id = #{id}
    </select>

    <select id="findByMobile" parameterType="string" resultMap="UserMap" >
        SELECT <include refid="cols_all" />
        FROM <include refid="tb" />
        WHERE mobile = #{mobile}
    </select>

    <select id="findByEmail" parameterType="string" resultMap="UserMap" >
        SELECT <include refid="cols_all" />
        FROM <include refid="tb" />
        WHERE email = #{email}
    </select>

    <update id="update" parameterType="User">
        UPDATE
        <include refid="tb"/>
        <set>
            updated_at = now()
            <if test="userName != null" > ,`user_name` = #{userName}</if>
            <if test="mobile != null" > ,`mobile` = #{mobile}</if>
            <if test="email != null" > ,`email` = #{email}</if>
            <if test="password != null" > ,`password` = #{password}</if>
            <if test="status != null" > ,`status` = #{status}</if>
            <if test="QqToken != null" > ,`qq_token` = #{QqToken}</if>
            <if test="weixinToken != null" > ,`weixin_token` = #{weixinToken}</if>
            <if test="weiboToken != null" > ,`weibo_token` = #{weiboToken}</if>
            <if test="nickname != null" > ,`nickname` = #{nickname}</if>
            <if test="type != null" > ,`type` = #{type}</if>
            <if test="gender != null" > ,`gender` = #{gender}</if>
            <if test="birthday != null" > ,`birthday` = #{birthday}</if>
            <if test="image != null" > ,`image` = #{image}</if>
            <if test="createdAt != null" > ,`created_at` = #{createdAt}</if>
        </set>
        WHERE id=#{id}
    </update>


    <delete id="delete" parameterType="long">
        DELETE FROM <include refid="tb"/>
        WHERE id = #{id}
    </delete>


</mapper>